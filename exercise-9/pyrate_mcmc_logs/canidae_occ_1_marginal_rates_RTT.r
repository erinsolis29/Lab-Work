# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canidae_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canidae_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.151519509053, 0.151519509053,0.152187237202,0.152187237202,0.0616279993109,0.054010615154,0.0475500565103,0.0426791001371,0.0508770742818,0.0508770742818,0.0508770742818,0.0508770742818,0.0508770742818,0.0508770742818,0.0508770742818,0.0508770742818,0.0475500565103,0.0475500565103,0.051147404022,0.057591077845,0.0672120908766,0.0889886278969,0.0946851289542,0.0995205910911,0.0995205910911,0.0999629119752,0.104637243446,0.108723492868,0.108723492868,0.114577624077,0.123370932443,0.128290336505,0.120217788525,0.124984567882,0.151036773208,0.147966630754,0.144645387087,0.144645387087,0.144645387087,0.113699367233,0.113699367233,0.109749445071,0.0985307325568,0.0985307325568,0.0985307325568,0.100999959978,0.0985307325568,0.0985307325568,0.0985307325568,0.0848434500104,0.0848434500104,0.0848434500104,0.0848434500104,0.0848434500104,0.0848434500104)
L_hpd_M95=c(0.384958198123, 0.384958198123,0.384958198123,0.384958198123,0.360781688665,0.330128769532,0.170336456664,0.132299274664,0.132299274664,0.131991324705,0.13082285746,0.130167270509,0.130167270509,0.130167270509,0.130167270509,0.13082285746,0.131991324705,0.138847114399,0.156982448987,0.197235558316,0.215489302006,0.22719846505,0.22719846505,0.229500853267,0.22719846505,0.22719846505,0.229500853267,0.240322324597,0.240322324597,0.248013016599,0.28903477998,0.345240702324,0.372744171582,0.372744171582,0.40544838299,0.408223061708,0.408223061708,0.408223061708,0.408223061708,0.382875158733,0.402835387164,0.382875158733,0.382875158733,0.408223061708,0.408223061708,0.435614787984,0.435614787984,0.435614787984,0.44460640878,0.44460640878,0.44460640878,0.44460640878,0.44460640878,0.44460640878,0.44460640878)
M_hpd_m95=c(0.38634220135, 0.38634220135,0.0865751430474,0.0865751430474,0.0865751430474,0.0865751430474,0.0707274850698,0.0607074724656,0.0809872089092,0.0809872089092,0.0809872089092,0.0892133338429,0.0892133338429,0.0892133338429,0.0892133338429,0.0892133338429,0.0892133338429,0.0892133338429,0.0892133338429,0.0892133338429,0.0892133338429,0.0652123538536,0.0597095783168,0.0597095783168,0.0597095783168,0.0597095783168,0.0597095783168,0.0546007324357,0.0546007324357,0.0546007324357,0.0546007324357,0.0546007324357,0.0546007324357,0.0546007324357,0.0546007324357,0.0546007324357,0.0546007324357,0.0510228415693,0.0510228415693,0.0510228415693,0.0510228415693,0.0510228415693,0.0496849470464,0.0496849470464,0.0496849470464,0.0496849470464,0.0496849470464,0.0496849470464,0.0496849470464,0.0496849470464,0.0496849470464,0.0496849470464,0.0496849470464,0.0496849470464,0.0496849470464)
M_hpd_M95=c(1.44691514009, 1.44691514009,0.367455006274,0.367455006274,0.367455006274,0.367455006274,0.211524333509,0.147411026753,0.147411026753,0.145053809948,0.142626203979,0.147411026753,0.147411026753,0.145053809948,0.145053809948,0.145053809948,0.145053809948,0.145053809948,0.145053809948,0.145053809948,0.145053809948,0.138994324462,0.132545432486,0.128302072903,0.126971068052,0.12600932484,0.12600932484,0.123430255682,0.121717165568,0.121717165568,0.121717165568,0.121717165568,0.121717165568,0.121717165568,0.121717165568,0.121717165568,0.121717165568,0.121717165568,0.121717165568,0.126290073361,0.128306430617,0.128306430617,0.128306430617,0.128306430617,0.128306430617,0.128306430617,0.128306430617,0.128306430617,0.128306430617,0.128306430617,0.128306430617,0.128306430617,0.128306430617,0.128306430617,0.128306430617)
R_hpd_m95=c(-1.18253056513, -1.18253056513,-0.127923728372,-0.127923728372,-0.144397198738,-0.147270044815,-0.17164184018,-0.0894399166293,-0.0894399166293,-0.0854801749057,-0.0876773049719,-0.0766364053329,-0.0766364053329,-0.0766364053329,-0.0766364053329,-0.0854801749057,-0.0839888247246,-0.0854801749057,-0.0839888247246,-0.0731906391026,-0.0467005779934,-0.0262010266364,-0.021157788109,-0.00121969953969,0.00820815249478,0.0184348878826,0.0184348878826,0.010188388834,0.0288084470426,0.0288084470426,0.0288084470426,0.0288084470426,0.0424925289998,0.0424925289998,0.0286692201127,0.0424925289998,0.010188388834,0.0286692201127,0.0286692201127,0.010188388834,0.010188388834,0.00718135049076,0.00364046136989,0.00105965723553,0.00105965723553,-0.0041302164439,-0.0041302164439,-0.0041302164439,-0.0041302164439,-0.0236985231118,-0.0236985231118,-0.0236985231118,-0.0236985231118,-0.0236985231118,-0.0236985231118)
R_hpd_M95=c(-0.103490283691, -0.103490283691,0.261366838747,0.261366838747,0.258214975003,0.219924806198,0.0624664269885,0.0492648978665,0.0220793668296,0.0220793668296,0.015586777205,0.0220793668296,0.0220793668296,0.0220793668296,0.0220793668296,0.010188388834,0.0220793668296,0.0271932007048,0.0492648978665,0.0889496695589,0.115950379047,0.141232187509,0.142440969692,0.154084426886,0.15832814132,0.15832814132,0.15832814132,0.158976618772,0.167073077314,0.167073077314,0.208885281331,0.264095888614,0.301056995724,0.301056995724,0.301056995724,0.330484652355,0.301056995724,0.328980078397,0.328980078397,0.301056995724,0.330484652355,0.301056995724,0.301056995724,0.330484652355,0.330484652355,0.332334242596,0.343340005857,0.349860150594,0.360076744841,0.349860150594,0.349860150594,0.349860150594,0.349860150594,0.349860150594,0.349860150594)
L_mean=c(0.29052256176, 0.29052256176,0.291066147121,0.291066147121,0.247743427385,0.168808665878,0.0896571050095,0.0843327532604,0.0828647602027,0.0828300927837,0.0817445900301,0.081908496938,0.0819978656833,0.0819978656833,0.0819978656833,0.0822624794843,0.0829474746379,0.0836552589445,0.087773609967,0.12442845808,0.1555764065,0.169824528822,0.172091609643,0.172303909792,0.172334942662,0.173024043735,0.173591898145,0.178754901307,0.182069396743,0.184020431233,0.191567391497,0.219811219688,0.23697371273,0.240754478225,0.245695754414,0.247578910824,0.246707494325,0.246806293474,0.248174329135,0.245385273816,0.244754597976,0.237761959942,0.238710841301,0.238654357815,0.239591919728,0.243778757778,0.246854291625,0.249004894462,0.250791239421,0.252709827272,0.252572520214,0.252601658333,0.252601658333,0.252601658333,0.252601658333)
M_mean=c(1.13001365534, 1.13001365534,0.148257298009,0.148257298009,0.148257298009,0.14793265026,0.124633646045,0.117941793698,0.11512195656,0.114589679307,0.115189097434,0.115444933092,0.115444933092,0.115547698512,0.115547698512,0.115568045027,0.115608894807,0.115608894807,0.115608894807,0.115608894807,0.115608894807,0.107903080933,0.100294563024,0.0949866636192,0.0927492850714,0.0898936040122,0.0894970797789,0.088407039538,0.0880082881009,0.0880082881009,0.0880082881009,0.0880006025621,0.0880006025621,0.0880006025621,0.0880006025621,0.0880006025621,0.0880006025621,0.0876838232007,0.0876838232007,0.0874417869744,0.0865190359337,0.0865190359337,0.0863325143309,0.0863325143309,0.0863325143309,0.0863325143309,0.0863325143309,0.0863325143309,0.0863325143309,0.0863325143309,0.0863325143309,0.0863325143309,0.0863325143309,0.0863325143309,0.0863325143309)
R_mean=c(-0.839491093584, -0.839491093584,0.142808849112,0.142808849112,0.0994861293761,0.0208760156174,-0.0349765410353,-0.0336090404375,-0.0322571963572,-0.0317595865232,-0.0334445074036,-0.0335364361536,-0.0334470674083,-0.0335498328288,-0.0335498328288,-0.0333055655427,-0.0326614201689,-0.0319536358624,-0.0278352848399,0.00881956327286,0.0399675116929,0.0619214478885,0.0717970466189,0.0773172461731,0.0795856575908,0.0831304397224,0.0840948183661,0.0903478617692,0.0940611086418,0.0960121431323,0.103559103396,0.131810617126,0.148973110168,0.152753875663,0.157695151852,0.159578308262,0.158706891763,0.159122470273,0.160490505934,0.157943486842,0.158235562042,0.151242924008,0.15237832697,0.152321843484,0.153259405397,0.157446243447,0.160521777294,0.162672380131,0.16445872509,0.166377312941,0.166240005883,0.166269144002,0.166269144002,0.166269144002,0.166269144002)
trans=0.5
age=(0:(55-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.489067049658), xlim = c(-57.75,2.75), ylab = 'Speciation rate', xlab = 'Ma',main='canidae' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.59160665409), xlim = c(-57.75,2.75), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.30078362164, 0.396084419325), xlim = c(-57.75,2.75), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-57.75,2.75), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()