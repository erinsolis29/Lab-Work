# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.144533017354, 0.144533017354,0.144533017354,0.144533017354,0.133759168985,0.058526862785,0.0370465428278,0.0450944290811,0.0438182175921,0.0438182175921,0.0438182175921,0.0450944290811,0.0450944290811,0.0450944290811,0.0452938234761,0.0488446914398,0.0484336282009,0.0524838586124,0.0524838586124,0.0568604940848,0.0774320484345,0.0947612795259,0.0991308672809,0.0991308672809,0.0991308672809,0.0931437978742,0.0919184041698,0.0931437978742,0.0919184041698,0.0823074409713,0.0931437978742,0.0884318234157,0.128039783471,0.144533017354,0.144664245071,0.144533017354,0.144533017354,0.129186114692,0.128039783471,0.128039783471,0.128039783471,0.112481903561,0.112481903561,0.112481903561,0.11046735967,0.0986818600853,0.104043228939,0.101343510931,0.101343510931,0.101343510931,0.101343510931,0.101343510931,0.101343510931)
L_hpd_M95=c(0.348881594724, 0.348881594724,0.348881594724,0.348881594724,0.347363199903,0.327345508296,0.167994787228,0.144846618881,0.141375256804,0.141375256804,0.141375256804,0.141375256804,0.141375256804,0.141375256804,0.141375256804,0.146020792794,0.150494246272,0.1630476648,0.171632422906,0.199194521812,0.219301321683,0.219301321683,0.222646541812,0.221409325634,0.219301321683,0.209407832803,0.206037811566,0.209407832803,0.219414890839,0.24062837672,0.312613816843,0.36452434594,0.402557339089,0.415814462528,0.415814462528,0.409972841389,0.415814462528,0.409972841389,0.418381385698,0.417455875272,0.419953278144,0.3979597355,0.3979597355,0.3979597355,0.3979597355,0.409972841389,0.422762213157,0.422762213157,0.422762213157,0.448139042625,0.450535088022,0.460478167191,0.460478167191)
M_hpd_m95=c(0.877330070934, 0.877330070934,0.0938432994692,0.0938432994692,0.0938432994692,0.0938432994692,0.0938432994692,0.0935685291648,0.0933793418349,0.0933793418349,0.0933793418349,0.0933793418349,0.0933793418349,0.0933793418349,0.0836677852075,0.0779850316261,0.0773248796165,0.0749800969725,0.0752301584753,0.0752301584753,0.0752301584753,0.0729432021194,0.0720055018466,0.0594151083182,0.0514510684988,0.0491709053416,0.0450655700072,0.042254308295,0.042254308295,0.0420993919524,0.0420993919524,0.0420993919524,0.0420993919524,0.042254308295,0.042254308295,0.042254308295,0.039879588187,0.0352105682143,0.0352105682143,0.0352105682143,0.0307273699422,0.0307273699422,0.0352105682143,0.0307273699422,0.0352105682143,0.0307273699422,0.0307273699422,0.0307273699422,0.0307273699422,0.0307273699422,0.0307273699422,0.0307273699422,0.0307273699422)
M_hpd_M95=c(1.49145542606, 1.49145542606,0.183343455308,0.183343455308,0.183343455308,0.183300265352,0.180162071351,0.162045005458,0.153318866981,0.152876039625,0.153205240977,0.150541750086,0.150541750086,0.149278762743,0.146144591996,0.139492263939,0.137703973723,0.135115607701,0.136257274698,0.136257274698,0.136257274698,0.135115607701,0.136089774421,0.134992491349,0.132262743296,0.132262743296,0.126465797045,0.118273113926,0.116137483819,0.115573002393,0.115573002393,0.115573002393,0.115573002393,0.116137483819,0.116137483819,0.116137483819,0.115010971961,0.121350494096,0.132871912268,0.160030980538,0.173715014009,0.186601627054,0.194073714701,0.191956005078,0.213949620869,0.231173936094,0.231173936094,0.231173936094,0.231173936094,0.231173936094,0.231173936094,0.231173936094,0.231173936094)
R_hpd_m95=c(-1.25827569639, -1.25827569639,0.00666874816108,0.00666874816108,0.00666874816108,-0.058324245581,-0.130423663129,-0.0958103670609,-0.0933321242636,-0.0911104624677,-0.0933321242636,-0.0911104624677,-0.0911104624677,-0.0911104624677,-0.0792275737778,-0.0792275737778,-0.0802381751857,-0.0663447680677,-0.0688209371584,-0.0570270368676,-0.0399245653222,-0.0296159260493,-0.0219231081456,-0.0125590226998,-0.0066733825574,-0.00682075247932,-0.00621812917264,-0.0066733825574,-0.00793980406304,-0.0066733825574,-0.00793980406304,0.0227439211754,0.0463339235861,0.0482654359551,0.0520203195038,0.0544938827228,0.0482654359551,0.0480536888445,0.0409248762345,-0.00294030940581,-0.0229471996681,-0.0229471996681,-0.0229471996681,-0.0229471996681,-0.0403114992754,-0.0675220185814,-0.0675220185814,-0.0345418857846,-0.0403114992754,-0.0494110379825,-0.0571999746437,-0.0403114992754,-0.0403114992754)
R_hpd_M95=c(-0.599138620786, -0.599138620786,0.220232267676,0.220232267676,0.227511377107,0.22791060242,0.0574969513728,0.0287498445292,0.0225937020644,0.0225937020644,0.0225937020644,0.0225937020644,0.0225937020644,0.0225937020644,0.035124842554,0.0365689547481,0.0420493243851,0.0711379734822,0.0750120117199,0.104930397116,0.126611607852,0.126611607852,0.129070176647,0.13595210714,0.13693675102,0.136654095541,0.13693675102,0.13693675102,0.147652112231,0.182786813791,0.232382359095,0.328088051928,0.333031709235,0.333031709235,0.333031709235,0.331905141507,0.333031709235,0.347373223759,0.370824602024,0.34934291307,0.331905141507,0.331905141507,0.331905141507,0.331905141507,0.331905141507,0.345769672835,0.366885007541,0.398122427896,0.398122427896,0.422224360022,0.422224360022,0.465276164995,0.465276164995)
L_mean=c(0.261542313942, 0.261542313942,0.261542313942,0.261542313942,0.259971854121,0.22565910116,0.0916687985335,0.0850524712056,0.0840439861525,0.0840439861525,0.0840439861525,0.0843102262019,0.0845269968831,0.0847018593033,0.0849243440876,0.08571301683,0.0895874550611,0.0991033074636,0.10496434874,0.131953765362,0.149634568521,0.154836568863,0.1567499077,0.157496978589,0.154302725038,0.151907902693,0.151956095979,0.152472411033,0.155791437628,0.163459727071,0.186271484598,0.232372846971,0.259455786617,0.264670326857,0.268561748369,0.269733540844,0.26748440362,0.267278251868,0.267013586215,0.26174882936,0.258791629569,0.255518855913,0.254953532528,0.254594409581,0.254789827314,0.258060545663,0.259042911383,0.260468992965,0.260077739601,0.264026564418,0.263775386265,0.265633420206,0.265633420206)
M_mean=c(1.17737334517, 1.17737334517,0.127890262506,0.127890262506,0.127890262506,0.127547988049,0.126100310327,0.123084047219,0.120133160131,0.119768777709,0.11984338987,0.119667019879,0.119604310605,0.119225047388,0.11611075379,0.113359416259,0.110978592175,0.109008602878,0.108407729872,0.108021258865,0.108021258865,0.10710618948,0.1059328935,0.101974310806,0.0942121459828,0.0902670422571,0.0848545590725,0.0822952026355,0.0791521549026,0.0777484244912,0.0777212226382,0.0777212226382,0.0777489717227,0.0777980914793,0.0777980914793,0.0777980914793,0.0782048553676,0.0801893742205,0.0811789643431,0.08349974523,0.0851938111028,0.0869672902045,0.0873841577895,0.0880712927641,0.0925685576402,0.0954578894355,0.0958980006775,0.0960681908756,0.096132295519,0.096132295519,0.096132295519,0.096132295519,0.096132295519)
R_mean=c(-0.915831031228, -0.915831031228,0.133652051436,0.133652051436,0.132081591615,0.0981111131105,-0.0344315117937,-0.0380315760129,-0.0360891739786,-0.0357247915561,-0.0357994037174,-0.0353567936768,-0.0350773137221,-0.0345231880849,-0.0311864097029,-0.0276463994289,-0.0213911371141,-0.00990529541417,-0.00344338113156,0.023932506497,0.0416133096563,0.0477303793827,0.0508170142006,0.0555226677833,0.0600905790549,0.0616408604364,0.0671015369067,0.0701772083975,0.0766392827256,0.08571130258,0.10855026196,0.154651624333,0.181706814894,0.186872235377,0.19076365689,0.191935449365,0.189279548252,0.187088877647,0.185834621872,0.17824908413,0.173597818466,0.168551565708,0.167569374738,0.166523116817,0.162221269674,0.162602656228,0.163144910705,0.164400802089,0.163945444082,0.167894268899,0.167643090746,0.169501124687,0.169501124687)
trans=0.5
age=(0:(53-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.50652598391), xlim = c(-55.65,2.65), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.64060096867), xlim = c(-55.65,2.65), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.38410326603, 0.511803781494), xlim = c(-55.65,2.65), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-55.65,2.65), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()